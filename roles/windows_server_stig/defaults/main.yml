---
# =============================================================================
# Windows Server DISA STIG Compliance Role - Default Variables
# Enterprise-grade automation for government security standards
# =============================================================================

# =============================================================================
# BENCHMARK METADATA AND IDENTIFICATION
# =============================================================================

# DISA STIG Benchmark Information
windows_server__stig_benchmark_name: "Microsoft Windows Server 2022 Security Technical Implementation Guide"
windows_server__stig_benchmark_version: "V1R3"
windows_server__stig_benchmark_date: "2023-10-25"
windows_server__stig_profile: "STIG"
windows_server__stig_classification: "UNCLASSIFIED"

# Supported Windows Server versions for STIG compliance
windows_server__stig_supported_versions:
  - "2022"
  - "2019"

# =============================================================================
# ROLE EXECUTION CONTROL
# =============================================================================

# Control execution behavior
windows_server__stig_generate_report: true
windows_server__stig_fail_on_non_compliance: false
windows_server__stig_compliance_threshold: 95  # Percentage

# Selective control execution
windows_server__stig_skip_rules: []  # List of V-XXXXXX rules to skip
windows_server__stig_only_rules: []  # List of V-XXXXXX rules to run (if specified, only these run)

# Control categories to execute
windows_server__stig_categories:
  - "account_policies"
  - "audit_policies" 
  - "user_rights"
  - "security_options"
  - "registry_settings"
  - "system_services"

# =============================================================================
# COMPLIANCE REPORTING CONFIGURATION
# =============================================================================

# Report generation settings
windows_server__stig_report_format: "json"  # json, html, yaml
windows_server__stig_report_path: "C:\\temp\\stig_compliance_report.json"
windows_server__stig_report_include_metadata: true
windows_server__stig_report_include_failed_only: false

# =============================================================================
# STIG V-254238 through V-254244 - PASSWORD POLICY CONFIGURATION
# =============================================================================

# STIG V-254238 - Password history (24+ passwords required)
# Recommendation: Enforce 24 or more passwords remembered
windows_server__stig_password_history_size: 24

# STIG V-254239 - Maximum password age (60 days maximum)
# Recommendation: 60 days or less for government systems
windows_server__stig_maximum_password_age: 60

# STIG V-254240 - Minimum password age (1+ days required)
# Recommendation: 1 day minimum to prevent rapid password cycling
windows_server__stig_minimum_password_age: 1

# STIG V-254241 - Minimum password length (14+ characters required)
# Recommendation: 14 characters minimum for government systems
windows_server__stig_minimum_password_length: 14

# STIG V-254242 - Password complexity (must be enabled)
# Requirement: Password must meet complexity requirements
windows_server__stig_password_complexity_enabled: true

# STIG V-254243 - Reversible encryption (must be disabled)
# Requirement: Store passwords using reversible encryption disabled
windows_server__stig_password_reversible_encryption: false

# =============================================================================
# STIG V-254244 through V-254246 - ACCOUNT LOCKOUT POLICY
# =============================================================================

# STIG V-254244 - Account lockout duration (15+ minutes required)
# Recommendation: 15 minutes or indefinite lockout
windows_server__stig_account_lockout_duration: 15

# STIG V-254245 - Account lockout threshold (3 or fewer attempts)
# Requirement: 3 or fewer invalid logon attempts
windows_server__stig_account_lockout_threshold: 3

# STIG V-254246 - Reset lockout counter (15+ minutes required)
# Requirement: 15 minutes or more to reset counter
windows_server__stig_reset_account_lockout_counter: 15

# =============================================================================
# STIG V-254247 through V-254258 - AUDIT POLICY CONFIGURATION
# =============================================================================

# STIG V-254247 - Audit account logon events
windows_server__stig_audit_account_logon_events: "Success and Failure"

# STIG V-254248 - Audit account management
windows_server__stig_audit_account_management: "Success and Failure"

# STIG V-254249 - Audit detailed tracking
windows_server__stig_audit_detailed_tracking: "Success"

# STIG V-254250 - Audit directory service access
windows_server__stig_audit_directory_service_access: "Success and Failure"

# STIG V-254251 - Audit logon events
windows_server__stig_audit_logon_events: "Success and Failure"

# STIG V-254252 - Audit object access
windows_server__stig_audit_object_access: "Failure"

# STIG V-254253 - Audit policy change
windows_server__stig_audit_policy_change: "Success and Failure"

# STIG V-254254 - Audit privilege use
windows_server__stig_audit_privilege_use: "Failure"

# STIG V-254255 - Audit process tracking
windows_server__stig_audit_process_tracking: "No Auditing"

# STIG V-254256 - Audit system events
windows_server__stig_audit_system_events: "Success and Failure"

# =============================================================================
# STIG V-254259 through V-254350 - SECURITY OPTIONS
# =============================================================================

# STIG V-254259 - Interactive logon machine inactivity limit (900 seconds max)
windows_server__stig_interactive_logon_machine_inactivity_limit: 900

# STIG V-254260 - Interactive logon message title
windows_server__stig_interactive_logon_message_title: "US Department of Defense Warning Statement"

# STIG V-254261 - Interactive logon message text
windows_server__stig_interactive_logon_message_text: "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only."

# STIG V-254262 - Network security LAN Manager authentication level
windows_server__stig_network_security_lan_manager_authentication_level: 5

# STIG V-254263 - Network security LDAP client signing requirements
windows_server__stig_network_security_ldap_client_signing_requirements: "Require signing"

# STIG V-254264 - Network security NTLM minimum session security
windows_server__stig_network_security_ntlm_minimum_session_security: "Require NTLMv2 session security, Require 128-bit encryption"

# =============================================================================
# STIG V-254351 through V-254400 - REGISTRY SETTINGS
# =============================================================================

# STIG V-254351 - Autoplay disabled
windows_server__stig_autoplay_disabled: true

# STIG V-254352 - Remote assistance disabled
windows_server__stig_remote_assistance_disabled: true

# STIG V-254353 - Error reporting disabled
windows_server__stig_error_reporting_disabled: true

# =============================================================================
# STIG V-254401 through V-254450 - SYSTEM SERVICES
# =============================================================================

# Services that must be disabled per STIG requirements
windows_server__stig_services_to_disable:
  - "Fax"                    # STIG V-254401 - Fax service
  - "FTPSVC"                 # STIG V-254402 - FTP Publishing service
  - "IISADMIN"               # STIG V-254403 - IIS Admin service
  - "MSiSCSI"                # STIG V-254404 - Microsoft iSCSI service
  - "tlntsvr"                # STIG V-254405 - Telnet service
  - "Simple TCP/IP Services" # STIG V-254406 - Simple TCP/IP Services
  - "Print Spooler"          # STIG V-254407 - Print Spooler (if not needed)

# =============================================================================
# STIG V-254451 through V-254500 - USER RIGHTS ASSIGNMENT
# =============================================================================

# STIG V-254451 - Act as part of the operating system (should be empty)
windows_server__stig_act_as_part_of_operating_system: []

# STIG V-254452 - Add workstations to domain
windows_server__stig_add_workstations_to_domain: ["Administrators"]

# STIG V-254453 - Adjust memory quotas for a process
windows_server__stig_adjust_memory_quotas: ["Administrators", "LOCAL SERVICE", "NETWORK SERVICE"]

# STIG V-254454 - Allow log on locally
windows_server__stig_allow_log_on_locally: ["Administrators"]

# STIG V-254455 - Back up files and directories
windows_server__stig_back_up_files_and_directories: ["Administrators"]

# STIG V-254456 - Change the system time
windows_server__stig_change_system_time: ["Administrators", "LOCAL SERVICE"]

# STIG V-254457 - Create a pagefile
windows_server__stig_create_pagefile: ["Administrators"]

# STIG V-254458 - Debug programs (should be empty)
windows_server__stig_debug_programs: []

# STIG V-254459 - Deny log on as a batch job
windows_server__stig_deny_log_on_as_batch_job: ["Guests"]

# STIG V-254460 - Deny log on as a service
windows_server__stig_deny_log_on_as_service: ["Guests"]

# STIG V-254461 - Deny log on locally
windows_server__stig_deny_log_on_locally: ["Guests"]

# STIG V-254462 - Deny log on through Terminal Services/RDP
windows_server__stig_deny_log_on_through_remote_desktop: 
  - "Guests"
  - "Local account"
  - "Local account and member of Administrators group"

# =============================================================================
# STIG V-254501 through V-254520 - EVENT LOG CONFIGURATION
# =============================================================================

# STIG V-254501 - Application log maximum size (32 MB minimum)
windows_server__stig_application_log_maximum_size: 32768

# STIG V-254502 - Application log retention method
windows_server__stig_application_log_retention_method: "OverwriteAsNeeded"

# STIG V-254503 - Security log maximum size (196 MB minimum)
windows_server__stig_security_log_maximum_size: 196608

# STIG V-254504 - Security log retention method
windows_server__stig_security_log_retention_method: "OverwriteAsNeeded"

# STIG V-254505 - System log maximum size (32 MB minimum)
windows_server__stig_system_log_maximum_size: 32768

# STIG V-254506 - System log retention method
windows_server__stig_system_log_retention_method: "OverwriteAsNeeded"

# =============================================================================
# SYSTEM SERVICES CONFIGURATION VARIABLES
# =============================================================================

# Service requirements - Configure based on server role
windows_server__stig_print_spooler_required: false
windows_server__stig_remote_desktop_required: false
windows_server__stig_iis_required: false
windows_server__stig_search_required: false
windows_server__stig_dns_server_required: false
windows_server__stig_dhcp_server_required: false